"use strict";(self.webpackChunkconsumerportal_v2=self.webpackChunkconsumerportal_v2||[]).push([[593,40],{86593:function(e,t,r){r.r(t),r.d(t,{default:function(){return C}});var a=r(1413),n=r(74165),s=r(15861),o=r(29439),c=r(72791),i=r(62398),d=r(10040),l=r(39230),u=r(40642),f=r(57689),p=r(33098),h=r(744),g=r(73490),_=r(60151),m=r(80184),x=10;function C(e){var t=(0,l.$G)().t,r=(0,c.useState)(!0),C=(0,o.Z)(r,2),v=C[0],b=C[1],Z=(0,c.useState)({show:!1,title:"",message:""}),O=(0,o.Z)(Z,2),w=(O[0],O[1]),k=(0,c.useState)(!1),A=(0,o.Z)(k,2),y=A[0],E=A[1],L=(0,c.useState)(null),S=(0,o.Z)(L,2),I=S[0],P=S[1],R=(0,c.useState)([]),D=(0,o.Z)(R,2),N=D[0],T=D[1],j=(0,c.useState)(10),U=(0,o.Z)(j,2),F=U[0],M=U[1],z=(0,c.useState)({page:1,size:10,total:0,has_more:!1}),V=(0,o.Z)(z,2),Y=V[0],B=V[1],K=(0,c.useState)([]),X=(0,o.Z)(K,2),G=X[0],W=X[1],H=(0,c.useState)(),q=(0,o.Z)(H,2),$=q[0],J=q[1],Q=(0,c.useState)(!1),ee=(0,o.Z)(Q,2),te=ee[0],re=ee[1],ae=(0,c.useState)(!1),ne=(0,o.Z)(ae,2),se=ne[0],oe=ne[1],ce=(0,c.useState)(!1),ie=(0,o.Z)(ce,2),de=ie[0],le=ie[1],ue=(0,c.useState)(null),fe=(0,o.Z)(ue,2),pe=fe[0],he=fe[1],ge=(0,c.useState)(null),_e=(0,o.Z)(ge,2),me=(_e[0],_e[1],(0,c.useState)(null)),xe=(0,o.Z)(me,2),Ce=xe[0],ve=xe[1],be=(0,c.useState)({lat:35.157322,lng:33.313751}),Ze=(0,o.Z)(be,2),Oe=(Ze[0],Ze[1],(0,c.useState)(!1)),we=(0,o.Z)(Oe,2),ke=(we[0],we[1]),Ae=(0,c.useState)(!0),ye=(0,o.Z)(Ae,2),Ee=ye[0],Le=ye[1],Se=(0,c.useState)(!1),Ie=(0,o.Z)(Se,2),Pe=Ie[0],Re=Ie[1],De=(0,c.useState)(!1),Ne=(0,o.Z)(De,2),Te=Ne[0],je=Ne[1],Ue=(0,c.useState)(!1),Fe=(0,o.Z)(Ue,2),Me=Fe[0],ze=Fe[1],Ve=(0,c.useState)(!1),Ye=(0,o.Z)(Ve,2),Be=Ye[0],Ke=Ye[1],Xe=(0,c.useState)(null),Ge=(0,o.Z)(Xe,2),We=Ge[0],He=Ge[1],qe=(0,c.useState)(!1),$e=(0,o.Z)(qe,2),Je=$e[0],Qe=$e[1],et=u.cache.getAppConfig(),tt=(0,f.s0)(),rt=u.cache.getContact();(0,c.useEffect)((function(){at(),st(),nt()}),[]);var at=function(){if(window.natively.isIOSApp||window.natively.isAndroidApp){(new NativelyLocation).current(50,"Best","BALANCED",(function(e){var t={lat:e.latitude,lon:e.longitude};ve(t),b(!1)}))}else navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lon:e.coords.longitude};console.log("AAAAA location:",e),ve(t),b(!1)}),(function(e){console.log("getLocation err",e),b(!1)}),{timeout:6e4,enableHighAccuracy:!1})},nt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.default.contacts.getContactPreferredOrganisation();case 3:"OK"==(t=e.sent).code&&he(t.data&&t.data.organisations?t.data.organisations:[]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("load favourite shop exception:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),st=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var s,o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(!0),s=[],o={page:1,size:10,total:0},M(r),e.prev=4,e.next=7,i.default.orders.getMyOrders({page:t||Y.page,size:r||Y.size,include_total:!0});case 7:"OK"===(c=e.sent).code&&(console.log("result:",c),s=c.data.content?c.data.content:[],(o=c.data.paging).size<Y.size&&(o.size=Y.size)),T(s),B((0,a.Z)((0,a.Z)({},o),{},{size:r||void 0})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("load wallet transactions error:",e.t0);case 16:E(!1);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,r){return e.apply(this,arguments)}}(),ot=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r,s){var o,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.stopPropagation(),u.cache.clearOrder(),console.log("AAAA onReorder item: ",s),b(!0),e.prev=4,e.next=7,i.default.orders.getOrder(s.id);case 7:if("OK"!==(o=e.sent).code){e.next=44;break}if(s=(0,a.Z)((0,a.Z)({},s),o.data),console.log("item:",s),c=h.dataUtil.createItemsWithComponents(s.items),console.log("_newOrderItems:",c),d=h.dataUtil.checkOrderModalMarketPlace(et),console.log("isMarketPlace:",d),"DELIVERY"!=s.supply_method){e.next=26;break}if(!d){e.next=21;break}return e.next=19,it(s.address,s.fulfilled_by.id,c);case 19:e.next=23;break;case 21:return e.next=23,ft();case 23:ke(!0),e.next=42;break;case 26:if("PICK_UP"!=s.supply_method){e.next=42;break}return e.next=29,lt();case 29:if(e.sent){e.next=32;break}return e.abrupt("return",!1);case 32:if(!d){e.next=37;break}return e.next=35,ct(s.fulfilled_by,c);case 35:e.next=42;break;case 37:return e.next=39,u.cache.initOrder({mode:"REORDER",type:"PICK_UP",fulfilled_by:[]});case 39:return e.next=41,dt(c);case 41:oe(!0);case 42:e.next=45;break;case 44:bt({status:!0,message:t("EXCEPTION_PROCESS")});case 45:e.next=51;break;case 47:e.prev=47,e.t0=e.catch(4),console.log("AAAA onReOrder exception: ",e.t0),bt({status:!0,message:t("EXCEPTION_PROCESS")});case 51:b(!1);case 52:case"end":return e.stop()}}),e,null,[[4,47]])})));return function(t,r){return e.apply(this,arguments)}}(),ct=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r,a){var s,o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe(!1),s={supply_method:"PICK_UP"},r.address&&r.address&&(r.address.lat&&r.address.lon&&(s.lat_lot=r.address.lat+":"+r.address.lon),r.address.postal_code&&(s.postal_code=r.address.postal_code)),e.next=5,i.default.orders.estimateOrderFulfillment(s);case 5:if(!("OK"==(o=e.sent).code&&o.data&&o.data.fulfilled_by&&o.data.fulfilled_by.length>0)){e.next=20;break}if(!((c=o.data.fulfilled_by.filter((function(e){return e.id==r.id})))&&c.length>0)){e.next=17;break}return u.cache.setPickUpStore(c[0]),u.cache.initOrder({type:"PICK_UP",fulfilled_by:[]}),e.next=13,dt(a);case 13:return e.next=15,gt("PICK_UP",c[0].id,!0);case 15:e.next=18;break;case 17:bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_PICK_UP")});case 18:e.next=21;break;case 20:bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_PICK_UP")});case 21:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),it=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r,a,s){var o,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe(!1),!r){e.next=25;break}return o={supply_method:"DELIVERY"},r.id?o.address_id=r.id:r.lat&&r.lon&&(o.lat_lot=r.lat+":"+r.lon,o.postal_code=r.postal_code),e.next=6,i.default.orders.estimateOrderFulfillment(o);case 6:if(!("OK"==(c=e.sent).code&&c.data&&c.data.fulfilled_by&&c.data.fulfilled_by.length>0)){e.next=22;break}if(!((d=c.data.fulfilled_by.filter((function(e){return e.id==a})))&&d.length>0)){e.next=19;break}return e.next=12,u.cache.initOrder({mode:"REORDER",type:"DELIVERY",fulfilled_by:d[0],accept_change_fulfilled:!0});case 12:return e.next=14,u.cache.setDeliveryAddress(r);case 14:return dt(s),e.next=17,gt("DELIVERY",d[0].id,!0);case 17:e.next=20;break;case 19:bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY")});case 20:e.next=23;break;case 22:"CAN_NOT_FULFILL_ORDER_EXCEPTION"==c.code?bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY")}):bt({status:!0,message:t("DELIVERY_VALIDATION_LOCATION")});case 23:e.next=26;break;case 25:bt({status:!0,message:t("CAN_NOT_GET_CURRENT_LOCATION")});case 26:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),dt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,a,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=0;r<t.length;r++)(a=t[r]).product.name&&a.product.name.toLowerCase().includes("delivery")||(console.log("item:",a),s=h.dataUtil.createItemToReorder(a),console.log("xxxxxxx productToBeAdded:",s),u.cache.addToCart(s));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var r,a,s,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,e.prev=1,!Ce||Ce.location_detail){e.next=8;break}return e.next=5,i.default.config.getAddress({session_id:(0,_.newGUIDV2)(),latlng:Ce.lat+","+Ce.lon});case 5:a=e.sent,console.log("findAddress result: ",a),"OK"===a.code&&(s=a.data,(o=s?s.country_code:null)&&rt&&rt.country_agreement&&o!==rt.country_agreement?(bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_CURRENT_LOCATION"),callBackFn:function(){P({}),tt(p.config_path.locations)}}),r=!1):r=!0);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("onLookUpLocation ex: ",e.t0);case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),ut=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,i.default.orders.getOrder(r.id);case 4:"OK"==(a=e.sent).code?(J(a.data),re(!0)):bt({status:!0,message:t("EXCEPTION_PROCESS")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),bt({status:!0,message:t("EXCEPTION_PROCESS")});case 11:b(!1),console.log("order:",r);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.cache.clearOrder(),!Ce||Ce.location_detail){e.next=14;break}return b(!0),e.prev=3,e.next=6,i.default.config.getAddress({latlng:Ce.lat+","+Ce.lon});case 6:"OK"==(t=e.sent).code&&(t.data&&ve((function(e){return(0,a.Z)((0,a.Z)({},e),{},{location_detail:t.data})})),console.log("result.data.content :",t.data.content)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log("initDeliveryOrder find address exception:",e.t0);case 13:b(!1);case 14:oe(!0);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),u.cache.clearOrder(),e.prev=2,u.cache.initOrder({type:"DIRECT_SALE",fulfilled_by:[]}),e.next=6,i.default.orders.estimateOrderFulfillment({supply_method:"DIRECT_SALE",is_open:!0});case 6:return t=e.sent,console.log("AAAA onClickDirectSale result: ",t),"OK"==t.code&&t.data&&t.data.fulfilled_by&&t.data.fulfilled_by.length>0&&u.cache.setPickUpStore({payment_method_types:t.data.fulfilled_by[0].payment_method_types}),e.next=11,gt("DIRECT_SALE",null);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("initDirectSaleOrder exception:",e.t0),b(!1);case 17:b(!1);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),ht=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gt("PICK_UP",t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r,a){var s,o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.cache.setCatalogSelected(null),s=et.features.contact.order&&et.features.contact.order.order_catalogs?et.features.contact.order.order_catalogs:[],console.log("aaaaaaaa 11111:",s),0!=s.length){e.next=16;break}return e.prev=4,o={supply_method:t,fulfilled_by:r,ordering_time:Math.floor((new Date).getTime()/1e3)},e.next=8,i.default.orders.getOrderCatalogues(o);case 8:c=e.sent,console.log("aaaaaaaa 22222:",c),"OK"==c.code&&c.data.content&&c.data.content.length>0&&(s=c.data.content),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("getOrderCatalogs exception:",e.t0);case 16:a?(s&&s.length>0&&u.cache.setCatalogSelected(s[0]),tt(p.config_path.orders_cart_items,{state:{type:"reorder"}})):s&&1==s.length?(u.cache.setCatalogSelected(s[0]),tt(p.config_path.orders_menu)):s&&s.length>1?(W(s),je(!1),Qe(!0)):tt(p.config_path.orders_menu);case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,r,a){return e.apply(this,arguments)}}(),_t=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r){var a,s,o,c,d,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=51;break}if(a=h.dataUtil.checkOrderModalMarketPlace(et),s=h.dataUtil.filterContactPreferencesByType(pe,h.preferences_type.order),!(o=s&&s.id)&&!a){e.next=47;break}return b(!0),e.prev=6,c={supply_method:"DELIVERY"},r.id?c.address_id=r.id:r.lat&&r.lon&&(c.lat_lot=r.lat+":"+r.lon,c.postal_code=r.postal_code),o&&(c.requested_organisation_id=s.id),console.log("payload:",c),e.next=13,i.default.orders.estimateOrderFulfillment(c);case 13:if(d=e.sent,console.log("result:",d),!("OK"==d.code&&d.data&&d.data.fulfilled_by&&d.data.fulfilled_by.length>0)){e.next=20;break}return e.next=18,mt(d.data.fulfilled_by,r);case 18:e.next=38;break;case 20:if("CAN_NOT_FULFILL_ORDER_EXCEPTION"!=d.code){e.next=24;break}bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY")}),e.next=38;break;case 24:if(!o){e.next=37;break}return delete c.requested_organisation_id,e.next=28,i.default.orders.estimateOrderFulfillment(c);case 28:if(!("OK"==(l=e.sent).code&&l.data&&l.data.fulfilled_by&&l.data.fulfilled_by.length>0)){e.next=34;break}return e.next=32,mt(l.data.fulfilled_by,r);case 32:e.next=35;break;case 34:"CAN_NOT_FULFILL_ORDER_EXCEPTION"==l.code?bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY")}):bt({status:!0,message:t("DELIVERY_VALIDATION_LOCATION")});case 35:e.next=38;break;case 37:bt({status:!0,message:t("DELIVERY_VALIDATION_LOCATION")});case 38:e.next=44;break;case 40:e.prev=40,e.t0=e.catch(6),console.log("create order exception:",e.t0),bt({status:!0,message:t("EXCEPTION_PROCESS")});case 44:b(!1),e.next=49;break;case 47:u.cache.initOrder({type:"DELIVERY"}),u.cache.setDeliveryAddress(r);case 49:e.next=52;break;case 51:bt({status:!0,message:t("CAN_NOT_GET_CURRENT_LOCATION")});case 52:case"end":return e.stop()}}),e,null,[[6,40]])})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(r,a){var s,o,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.portal_config||!g.portal_config.isOrderWithFilterMerchant){e.next=16;break}return e.next=3,i.default.organisations.searchOrganisations({});case 3:if(s=e.sent,o="OK"==s.code&&s.data.content?s.data.content:[],!((c=h.dataUtil.compareMerchants(r,o))&&c.length>0)){e.next=13;break}return u.cache.initOrder({type:"DELIVERY",fulfilled_by:c[0],accept_change_fulfilled:!0}),u.cache.setDeliveryAddress(a),e.next=11,gt("DELIVERY",c[0].id);case 11:e.next=14;break;case 13:bt({status:!0,message:t("CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY")});case 14:e.next=20;break;case 16:return u.cache.initOrder({type:"DELIVERY",fulfilled_by:r[0],accept_change_fulfilled:!0}),u.cache.setDeliveryAddress(a),e.next=20,gt("DELIVERY",r[0].id);case 20:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),xt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.type,a=t.address,oe(!1),"address"!=r){e.next=7;break}return e.next=5,_t(a);case 5:e.next=8;break;case 7:le(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ct=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("AAA page:",t),e.next=3,st(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("AAA size:",t),e.next=3,st(1,t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bt=function(e){var t=e.status,r=e.title,a=e.message,n=e.otherMessage,s=e.callBackFn;b(!1),P({show:t,title:r,content:a,otherMessage:n,callBackFn:s||function(){return P({})}})},Zt=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t,r,s,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Re(!0),e.prev=1,t=1,r=1,M(x),Y&&Y.page&&(t=Y.page+1,r=Math.ceil(Y.total/x)),!(t<=r)){e.next=13;break}return e.next=9,i.default.orders.getMyOrders({include_total:!0,page:t,size:x});case 9:"OK"==(s=e.sent).code&&(o=N.concat(s.data.content),T(o),B((0,a.Z)((0,a.Z)({},s.data.paging),{},{size:Y.size}))),e.next=14;break;case 13:Le(!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log("AAAA handleLoadMore error:",e.t0);case 19:Re(!1);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}(),Ot=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ve((function(e){return(0,a.Z)((0,a.Z)({},e),{},{location_detail:t})})),e.next=3,_t(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsx)(d.default,{showProcessing:v,message:I,my_orders:N,paging:Y,size:F,showLoadingMyOrders:y,orderDetail:$,showDetail:te,currentLocation:Ce,catalogues:G,showAddresses:se,showCurrentLocation:de,hasMore:Ee,showLoadMore:Pe,showPickUpStore:Te,showAddressMap:Me,addressMode:We,showAddAddress:Be,showCatalog:Je,setShowPickUpStore:je,setShowCatalog:Qe,setShowCurrentLocation:le,setShowAddresses:oe,setShowDetail:re,onReOrder:ot,onShowDetail:ut,onClickDelivery:ft,onClickPickUp:function(){u.cache.clearOrder(),u.cache.initOrder({type:"PICK_UP",fulfilled_by:[]}),je(!0)},onClickDirectSale:pt,showMessage:bt,onSelectAddress:xt,cancelOrder:function(){u.cache.getCartItem().length>0?u.cache.clearOrder():w({show:!0,title:"",message:""})},handleChangePage:Ct,handleChangeRowsPerPage:vt,handleLoadMore:Zt,onGoBackPickUpStore:ht,onGoBackFromCurrrentLocation:Ot,onSelectAddressMap:function(){le(!1),ze(!0)},setShowAddressMap:ze,onCloseSelectAddressMap:function(e){ze(!1),"add"==We?(ve((function(t){return(0,a.Z)((0,a.Z)({},t),{},{location_detail:e})})),Ke(!0)):(ve((function(t){return(0,a.Z)((0,a.Z)({},t),{},{location_detail:e})})),le(!0))},onAddNewAddress:function(){oe(!1),ze(!0),He("add")},setShowAddAddress:Ke})}},10040:function(e,t,r){r.r(t),r.d(t,{default:function(){return M}});var a=r(1413),n=r(29439),s=r(72791),o=r(39230),c=r(30681),i=r(26580),d=(r(93941),r(40642)),l=r(42048),u=r(13967),f=r(53767),p=r(36151),h=r(13239),g=r(61336),_=r(61889),m=r(68870),x=r(34030),C=r(81918),v=r(20890),b=r(20696),Z=r(28195),O=r(28619),w=r(80806),k=(r(88216),r(81741)),A=r(9089),y=r(60263),E=r(60151),L=(r(14771),r(11356)),S=r(74131),I=r(24332),P=r(73452),R=r(87634),D=r(99298),N=r(744),T=r(73490),j=r(80184),U=D.custom_page.my_address&&D.custom_page.my_address.add_address&&D.custom_page.my_address.add_address.controller?r(11191).default:P.default,F=D.custom_page.my_address&&D.custom_page.my_address.address_map&&D.custom_page.my_address.address_map.controller?r(93458).default:I.default;function M(e){var t=d.cache.getAppConfig(),r=!!(t&&t.features&&t.features.contact&&t.features.contact.order&&t.features.contact.order.is_supported)&&t.features.contact.order.is_supported,C=!!(t&&t.features&&t.features.contact&&t.features.contact.order&&t.features.contact.order.is_supported&&t.features.contact.order.delivery&&t.features.contact.order.delivery.is_supported),v=!!(t&&t.features&&t.features.contact&&t.features.contact.order&&t.features.contact.order.is_supported&&t.features.contact.order.pick_up&&t.features.contact.order.pick_up.is_supported),E=!!(t&&t.features&&t.features.contact&&t.features.contact.order&&t.features.contact.order.is_supported&&t.features.contact.order.direct_sale&&t.features.contact.order.direct_sale.is_supported),I=(0,o.$G)().t,P=e.my_orders,D=e.currentLocation,N=e.showLoadingMyOrders,M=e.showDrawer,V=e.paging,Y=(0,s.useState)(V&&V.size?V.size:10),B=(0,n.Z)(Y,2),K=B[0],X=B[1],G=(0,u.Z)().palette;console.log("showDrawer:",M);var W=(0,l.checkActionPermission)(T.enumConfig.contactPermissions.ORDERS_MANAGEMENT);return(0,j.jsxs)(c.default,{showHeader:!0,showProcessing:e.showProcessing,showFooter:!0,message:e.message,subHeader:(0,j.jsx)(i.default,{title:I("orders_title"),variant:"action-buttons",action:(0,j.jsx)(j.Fragment,{children:r&&(0,j.jsxs)(f.Z,{direction:"row",spacing:1,children:[v&&(0,j.jsx)(p.Z,{sx:{borderRadius:32,height:32,padding:void 0,fontFamily:b.commonFont.medium,borderColor:G.border.dark,"&.MuiButtonBase-root:hover":{borderColor:"transparent"}},variant:"outlined",size:"small",disabled:!W,color:"shortcut",onClick:e.onClickPickUp,id:"orderMain/btnPickUp",children:I("pickup")}),C&&(0,j.jsx)(p.Z,{sx:{borderRadius:32,height:32,padding:void 0,fontFamily:b.commonFont.medium,borderColor:G.border.dark,"&.MuiButtonBase-root:hover":{borderColor:"transparent"}},variant:"outlined",size:"small",disabled:!W,color:"shortcut",onClick:e.onClickDelivery,id:"orderMain/btnDelivery",children:I("delivery")}),E&&(0,j.jsx)(p.Z,{sx:{borderRadius:32,height:32,padding:void 0,fontFamily:b.commonFont.medium,borderColor:G.border.dark,"&.MuiButtonBase-root:hover":{borderColor:"transparent"}},variant:"outlined",size:"small",disabled:!W,color:"shortcut",onClick:e.onClickDirectSale,id:"orderMain/btnDirectSale",children:I("order_direct_sale")})]})})}),children:[(0,j.jsx)(O.default,{noBorder:!0,marginTop:3,children:N?(0,j.jsx)("center",{children:(0,j.jsx)(h.Z,{})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g.Z,{mdDown:!0,children:(0,j.jsx)(Z.default,{data:P||[],tableConfig:w.ordersTableConfig,enablePaging:!0,paging:(0,a.Z)((0,a.Z)({},e.paging),{},{size:e.size?e.size:void 0}),handleChangePage:e.handleChangePage,handleChangeRowsPerPage:e.handleChangeRowsPerPage,onReOrder:e.onReOrder,onShowDetail:e.onShowDetail,disabledAction:!W})}),(0,j.jsx)(g.Z,{mdUp:!0,children:(0,j.jsxs)(_.ZP,{xs:12,item:!0,children:[P.map((function(t,r){return(0,j.jsx)(m.Z,{mb:1,children:(0,j.jsx)(z,{item:t,onReOrder:e.onReOrder,isAllowAction:W})},r)})),(0,j.jsx)(x.Z,{component:"div",count:V.total,onPageChange:function(t,r){e.handleChangePage(r+1)},rowsPerPage:K,page:V.page?V.page-1:0,onRowsPerPageChange:function(t){var r=t.target.value,a=V.size?V.size:10;console.log("AAA parseInt(value, _size): ",parseInt(r,a)),X(r),e.handleChangeRowsPerPage(r)}})]})})]})}),e.orderDetail&&(0,j.jsx)(y.default,{orderSelected:e.orderDetail,isOpen:e.showDetail,onClose:function(){return e.setShowDetail(!1)}}),e.showAddresses&&(0,j.jsx)(k.default,{enableCloseButton:!0,maxWidth:"md",isOpen:e.showAddresses,title:I("select_your_delivery_address"),onClose:function(){return e.setShowAddresses(!1)},children:(0,j.jsx)(A.default,{currentLocation:D,onSelectAddress:e.onSelectAddress,onAddNewAddress:e.onAddNewAddress})}),e.showCurrentLocation&&(0,j.jsx)(k.default,{enableCloseButton:!0,maxWidth:"md",isOpen:e.showCurrentLocation,title:I("my_address"),onClose:function(){return e.setShowCurrentLocation(!1)},children:(0,j.jsx)(S.default,{currentLocation:D,onGoBack:e.onGoBackFromCurrrentLocation,onSelectAddressMap:e.onSelectAddressMap})}),e.showPickUpStore&&(0,j.jsx)(L.default,{onClose:function(){return e.setShowPickUpStore(!1)},isOpen:e.showPickUpStore,showMessage:e.showMessage,currentLocation:D,onGoBackPickUpStore:e.onGoBackPickUpStore}),e.showAddressMap&&(0,j.jsx)(F,{open:e.showAddressMap,onClose:function(){return e.setShowAddressMap(!1)},onGoBackFn:e.onCloseSelectAddressMap}),e.showAddAddress&&(0,j.jsx)(U,{open:e.showAddAddress,address_info:D&&D.location_detail?D.location_detail:null,mode:"add",onClose:function(){return e.setShowAddAddress(!1)},onRefresh:function(){return e.setShowAddresses(!0)}}),e.showCatalog&&(0,j.jsx)(R.default,{catalogues:e.catalogues,open:e.showCatalog,onClose:function(){return e.setShowCatalog(!1)}})]})}function z(e){var t=e.item,r=e.onReOrder,a=e.isAllowAction,n=(0,o.$G)().t,s=(0,u.Z)().palette,c=d.cache.getCurrency(),i="info";"COMPLETED"==t.state?i="success":"CANCELLED"==t.state?i="error":"NEW"==t.state&&(i="info");var l="info";"PICK_UP"==t.supply_method?l="custom1":"DELIVERY"==t.supply_method?l="custom2":"DIRECT_SALE"==t.supply_method&&(l="custom3");var h=N.dataUtil.createItemsWithComponents(t.items),g=function(e){var t="";return e.forEach((function(e){t=t+e.name+", "})),t&&(t=t.substr(0,t.length-2)),t};return(0,j.jsxs)(O.default,{paddingY:1,paddingX:2,children:[(0,j.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:1,mb:1,children:[(0,j.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:1,flex:1,children:[(0,j.jsx)(C.Z,{size:"small",variant:"customOutlined",sx:{background:s[i].light,color:s[i].main},label:n((0,E.mappingValue)(t.state))}),(0,j.jsx)(C.Z,{size:"small",variant:"customOutlined",sx:{background:s[l].light,color:s[l].main},label:n((0,E.mappingValue)(t.supply_method))})]}),"DIRECT_SALE"!=t.supply_method&&(0,j.jsx)(f.Z,{flex:.3,direction:"row",justifyContent:"flex-end",children:(0,j.jsx)(p.Z,{variant:"text",id:"orders/ReOrder/"+t.number,sx:{paddingY:0},disabled:!a,onClick:function(e){return r(e,t)},children:n("re-order")})})]}),(0,j.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,j.jsx)(f.Z,{flex:1,children:(0,j.jsx)(v.Z,{variant:"body2",children:t.fulfilled_by&&t.fulfilled_by.name?t.fulfilled_by.name:null})}),(0,j.jsx)(f.Z,{flex:.3,direction:"row",justifyContent:"flex-end",children:(0,j.jsxs)(v.Z,{variant:"body2",children:[c,t.total?(0,E.formatAmount)(t.total,T.portal_config.isFormatDecimalBalance):"0.00"]})})]}),(0,j.jsx)(f.Z,{direction:"row",alignItems:"center",spacing:1,children:(0,j.jsx)(f.Z,{flex:1,children:(0,j.jsx)(v.Z,{variant:"subtitle2",children:t.submitted_date?(0,E.formatDateToDDMMYYYYHHSSFrEpoch)(t.submitted_date):null})})}),(0,j.jsx)(m.Z,{mt:.5,children:h.map((function(e,t){return e.product&&"EXPENSES_SERVICE"!=e.product.classification?(0,j.jsxs)(m.Z,{children:[(0,j.jsxs)(f.Z,{direction:"row",children:[(0,j.jsxs)(v.Z,{variant:"subtitle2",component:"span",children:[e.product.quantity," x "]}),(0,j.jsx)(v.Z,{variant:"subtitle2",fontWeight:"bold",component:"span",pl:.5,children:e.product.name})]},t),e.product.components&&e.product.components.length>0?(0,j.jsx)(v.Z,{variant:"subtitle2",children:g(e.product.components)}):null]},t):null}))})]})}}}]);
//# sourceMappingURL=593.af79954c.chunk.js.map