"use strict";(self.webpackChunkconsumerportal_v2=self.webpackChunkconsumerportal_v2||[]).push([[610,752],{37610:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var a=r(74165),n=r(15861),s=r(29439),c=r(72791),i=(r(91356),r(40642)),o=r(62752),l=r(62398),u=r(97927),d=r(57689),m=r(33098),_=r(39230),h=(r(60151),r(80184));function g(e){var t=(0,_.$G)().t,r=(0,d.s0)(),g=(0,c.useState)(!1),f=(0,s.Z)(g,2),p=f[0],x=f[1],v=(0,c.useState)(null),E=(0,s.Z)(v,2),C=E[0],O=E[1],y=(0,c.useState)(void 0),j=(0,s.Z)(y,2),I=j[0],Z=j[1],T=(0,c.useState)(void 0),k=(0,s.Z)(T,2),N=k[0],A=k[1],R=(0,c.useState)(null),w=(0,s.Z)(R,2),b=w[0],P=w[1],D=i.cache.getOrderType(),F=i.cache.getOrderRegion();(0,c.useEffect)((function(){L()}),[]);var L=function(){var e=(0,n.Z)((0,a.Z)().mark((function e(){var r,n,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!0),r=window.location.pathname,n=i.cache.getOrderToken(i.order_key.order_token),s=r.split("/"),c=s.pop(),!(r&&r.search(n)>0&&r.includes("success"))){e.next=10;break}return e.next=8,M(c);case 8:e.next=12;break;case 10:B({status:!0,message:t("ORDER_PAYMENT_FAILED")}),Z(!1);case 12:x(!1);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,n.Z)((0,a.Z)().mark((function e(r){var n,s,c,o,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=i.cache.getOrderToBeProcess(),r&&(n.intent_id=r),e.next=5,l.default.orders.makeOrder(n);case 5:if("OK"!=(s=e.sent).code){e.next=16;break}return c=s.data,e.next=10,l.default.orders.getOrder(s.data.id);case 10:"OK"===(o=e.sent).code&&(c.key_dates=o.data.key_dates,c.total_cost=o.data.total,c.order_items=o.data.items,c.amount_due=o.data.amount_due),P(c),A(!0),e.next=17;break;case 16:"CAN_NOT_FULFILL_ORDER_EXCEPTION"==s.code?B({status:!0,message:t("DELIVERY"===D?"CAN_NOT_FULFILL_ORDER_EXCEPTION_DELIVERY":"CAN_NOT_FULFILL_ORDER_EXCEPTION_PICK_UP")}):"MINIMUM_ORDER_AMOUNT_NOT_REACHED"==s.code?(u=s.data&&s.data.parameters&&s.data.parameters.length>0?s.data.parameters[0]:"\u20ac0.00",B({status:!0,message:t("MINIMUM_ORDER_AMOUNT_NOT_REACHED")+u})):"CANNOTEXECUTEACTIONCREDITLIMITEXCEPTION"==s.code?B({status:!0,message:t("CANNOTEXECUTEACTIONCREDITLIMITEXCEPTION")}):B({status:!0,message:t("EXCEPTION_PROCESS")});case 17:Z(!1),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),console.log("AAAA processMakeOrder exception: ",e.t0),Z(!1);case 24:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}(),B=function(e){var t=e.status,r=e.title,a=e.message,n=e.otherMessage,s=e.callBackFn;x(!1),O({show:t,title:r,content:a,otherMessage:n,callBackFn:s||function(){return O({})}})},U=function(){A(!1),i.cache.clearOrder(),"commerce"==e.from?r(m.config_path.commerce):r(m.config_path.home),i.cache.clearOrder()};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(o.default,{showProcessing:p,message:C,orderStatus:I,onClose:U}),N&&(0,h.jsx)(u.default,{isOpen:N,order_result:b,order_type:D,region:F,pick_up_store:i.cache.getCacheByKey(i.order_key.pick_up_store),delivery_address:i.cache.getCacheByKey(i.order_key.delivery_address),contact_phone:i.cache.getCacheByKey(i.order_key.contact_phone),estimate_order_result:i.cache.getCacheByKey(i.order_key.estimate_order_result),onClose:U})]})}},62752:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var a=r(43438),n=r(13967),s=r(61889),c=r(20890),i=r(53767),o=r(68870),l=(r(72791),r(39230)),u=r(30681),d=r(81741),m=r(59056),_=r(73490),h=r(40642),g=r(42048),f=r(60151),p=r(744),x=r(80184);function v(e){var t=(0,l.$G)().t,r=e.message,a=(0,n.Z)().palette;console.log("AAAA ProcessView: ",e);var m=h.cache.getCurrency(),g=h.cache.getCartItem(),v=h.cache.getCacheByKey(h.order_key.estimate_order_result),C=function(e){var t="";return e.forEach((function(e){t=t+e.name+", "})),t&&(t=t.substr(0,t.length-2)),t},O=function(e){var t="";return e.forEach((function(e){t=t+e.value+", "})),t&&(t=t.substr(0,t.length-2)),t};return(0,x.jsx)(u.default,{showProcessing:e.showProcessing,children:(0,x.jsx)(d.default,{isOpen:0==e.orderStatus,onClose:e.onClose,enableCloseButton:!0,title:t("order_failed"),children:(0,x.jsxs)(s.ZP,{item:!0,xs:12,children:[(0,x.jsx)(s.ZP,{item:!0,xs:12,container:!0,justifyContent:"center",my:1,children:r&&r.show&&(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(c.Z,{variant:"subtitle1",color:a.error.main,children:r.content})})}),g&&g.length>0&&g.map((function(e,t){return(0,x.jsxs)(i.Z,{direction:"row",flex:1,spacing:2,marginTop:2,marginBottom:2,position:"relative",children:[(0,x.jsx)(i.Z,{sx:{width:80},children:(0,x.jsx)(E,{image:p.dataUtil.getImageByUsageType(e.creatives,p.usage_type.product_item)})}),(0,x.jsxs)(i.Z,{flex:2,children:[(0,x.jsxs)(i.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,x.jsxs)(c.Z,{variant:"subtitle1",children:[e.quantity,"x ",e.name]}),e.variant_selected&&e.variant_selected.length>0&&(0,x.jsx)(c.Z,{color:"primary",variant:"subtitle1",children:O(e.variant_selected)})]}),e.components&&e.components.length>0&&(0,x.jsx)(s.ZP,{xs:12,item:!0,marginTop:.5,children:(0,x.jsx)(c.Z,{variant:"subtitle2",children:C(e.components)})})]})]},t)})),(0,x.jsxs)(o.Z,{children:[(0,x.jsxs)(i.Z,{flex:1,direction:"row",spacing:1,justifyContent:"flex-end",alignItems:"flex-end",marginRight:5,children:[(0,x.jsxs)(c.Z,{variant:"subtitle2",children:[t("total"),":"]}),(0,x.jsxs)(c.Z,{variant:"subtitle1",children:[m,v&&v.invoice_estimate&&v.invoice_estimate.total?(0,f.formatAmount)(v.invoice_estimate.total,_.portal_config.isFormatDecimalBalance):"0.00"]})]}),(0,x.jsxs)(i.Z,{flex:1,direction:"row",spacing:1,justifyContent:"flex-end",alignItems:"flex-end",marginRight:5,children:[(0,x.jsxs)(c.Z,{variant:"subtitle2",children:[t("amount_due"),":"]}),(0,x.jsxs)(c.Z,{variant:"subtitle1",children:[m,v&&v.invoice_estimate&&v.invoice_estimate.amount_due?(0,f.formatAmount)(v.invoice_estimate.amount_due,_.portal_config.isFormatDecimalBalance):"0.00"]})]})]})]})})})}function E(e){var t=C();return e.image&&e.image.length>0?(0,x.jsx)(m.default,{media:e.image,classes:t.process_item_image}):(0,x.jsx)("img",{src:(0,g.getLogoImage)(),width:80,height:80,style:{objectFit:"cover"}})}var C=(0,a.Z)((function(e){return{process_item_image:{width:80,height:80,objectFit:"cover"}}}))}}]);
//# sourceMappingURL=610.4033e45b.chunk.js.map